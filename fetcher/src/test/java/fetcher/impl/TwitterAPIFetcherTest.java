package fetcher.impl;

import fetcher.impl.connectors.TwitterAPIConnector;
import interfaces.PropertiesManager;
import model.News;
import model.Preferences;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.Mockito;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

import javax.json.Json;
import javax.json.JsonArray;
import javax.json.JsonReader;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.StringReader;
import java.util.List;

import static org.junit.Assert.assertEquals;


@RunWith(PowerMockRunner.class)
@PrepareForTest({TwitterAPIFetcher.class, TwitterAPIConnector.class})
public class TwitterAPIFetcherTest {

    @org.mockito.Mock
    private Preferences preferences;

    @org.mockito.Mock
    private TwitterAPIConnector twitterAPIConnector;

    private TwitterAPIFetcher twitterAPIFetcher;


    @Before
    public void setUp() throws Exception {

        Mockito.when(preferences.getKeyword()).thenReturn("Trump");
        Mockito.when(preferences.getNewsSource()).thenReturn("Trump");

        String data = "[{\"created_at\":\"Tue Jan 16 19:26:56 +0000 2018\",\"id\":953347857880354822,\"id_str\":\"953347857880354822\",\"text\":\"Routed on over 500 acres and forged from what was previously flat and barren desert, @TrumpGolfDubai has become a p… https://t.co/2K5XAz7Yt1\",\"truncated\":true,\"entities\":{\"hashtags\":[],\"symbols\":[],\"user_mentions\":[{\"screen_name\":\"TrumpGolfDubai\",\"name\":\"Trump Dubai\",\"id\":4330756895,\"id_str\":\"4330756895\",\"indices\":[85,100]}],\"urls\":[{\"url\":\"https://t.co/2K5XAz7Yt1\",\"expanded_url\":\"https://twitter.com/i/web/status/953347857880354822\",\"display_url\":\"twitter.com/i/web/status/9…\",\"indices\":[117,140]}]},\"metadata\":{\"iso_language_code\":\"en\",\"result_type\":\"recent\"},\"source\":\"<a href=\\\"http://twitter.com\\\" rel=\\\"nofollow\\\">Twitter Web Client</a>\",\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":720293443260456960,\"id_str\":\"720293443260456960\",\"name\":\"The Trump Organization\",\"screen_name\":\"Trump\",\"location\":\"New York, NY\",\"description\":\"The official Twitter page of The @Trump Organization. The most globally recognized brand in luxury real estate, golf, hospitality, and entertainment \uD83C\uDF0E\",\"url\":\"https://t.co/2qPo57KgoO\",\"entities\":{\"url\":{\"urls\":[{\"url\":\"https://t.co/2qPo57KgoO\",\"expanded_url\":\"http://TrumpStore.com\",\"display_url\":\"TrumpStore.com\",\"indices\":[0,23]}]},\"description\":{\"urls\":[]}},\"protected\":false,\"followers_count\":294711,\"friends_count\":50,\"listed_count\":1127,\"created_at\":\"Wed Apr 13 16:51:54 +0000 2016\",\"favourites_count\":3723,\"utc_offset\":-18000,\"time_zone\":\"Eastern Time (US & Canada)\",\"geo_enabled\":true,\"verified\":true,\"statuses_count\":479,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"is_translation_enabled\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_image_url_https\":\"https://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_tile\":false,\"profile_image_url\":\"http://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_image_url_https\":\"https://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_banner_url\":\"https://pbs.twimg.com/profile_banners/720293443260456960/1505756130\",\"profile_link_color\":\"B6B6B4\",\"profile_sidebar_border_color\":\"000000\",\"profile_sidebar_fill_color\":\"000000\",\"profile_text_color\":\"000000\",\"profile_use_background_image\":false,\"has_extended_profile\":false,\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"translator_type\":\"none\"},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":23,\"favorite_count\":87,\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"lang\":\"en\"},{\"created_at\":\"Fri Jan 12 19:01:56 +0000 2018\",\"id\":951892015654096896,\"id_str\":\"951892015654096896\",\"text\":\"View our 4Q 2017 @TrumpRealty Luxury Market Report, featuring the latest luxury market statistics and analysis… https://t.co/2PrN1C3hBG\",\"truncated\":true,\"entities\":{\"hashtags\":[],\"symbols\":[],\"user_mentions\":[{\"screen_name\":\"TrumpRealty\",\"name\":\"Trump Realty\",\"id\":2174527993,\"id_str\":\"2174527993\",\"indices\":[17,29]}],\"urls\":[{\"url\":\"https://t.co/2PrN1C3hBG\",\"expanded_url\":\"https://twitter.com/i/web/status/951892015654096896\",\"display_url\":\"twitter.com/i/web/status/9…\",\"indices\":[112,135]}]},\"metadata\":{\"iso_language_code\":\"en\",\"result_type\":\"recent\"},\"source\":\"<a href=\\\"http://twitter.com\\\" rel=\\\"nofollow\\\">Twitter Web Client</a>\",\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":720293443260456960,\"id_str\":\"720293443260456960\",\"name\":\"The Trump Organization\",\"screen_name\":\"Trump\",\"location\":\"New York, NY\",\"description\":\"The official Twitter page of The @Trump Organization. The most globally recognized brand in luxury real estate, golf, hospitality, and entertainment \uD83C\uDF0E\",\"url\":\"https://t.co/2qPo57KgoO\",\"entities\":{\"url\":{\"urls\":[{\"url\":\"https://t.co/2qPo57KgoO\",\"expanded_url\":\"http://TrumpStore.com\",\"display_url\":\"TrumpStore.com\",\"indices\":[0,23]}]},\"description\":{\"urls\":[]}},\"protected\":false,\"followers_count\":294711,\"friends_count\":50,\"listed_count\":1127,\"created_at\":\"Wed Apr 13 16:51:54 +0000 2016\",\"favourites_count\":3723,\"utc_offset\":-18000,\"time_zone\":\"Eastern Time (US & Canada)\",\"geo_enabled\":true,\"verified\":true,\"statuses_count\":479,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"is_translation_enabled\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_image_url_https\":\"https://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_tile\":false,\"profile_image_url\":\"http://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_image_url_https\":\"https://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_banner_url\":\"https://pbs.twimg.com/profile_banners/720293443260456960/1505756130\",\"profile_link_color\":\"B6B6B4\",\"profile_sidebar_border_color\":\"000000\",\"profile_sidebar_fill_color\":\"000000\",\"profile_text_color\":\"000000\",\"profile_use_background_image\":false,\"has_extended_profile\":false,\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"translator_type\":\"none\"},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":152,\"favorite_count\":722,\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"lang\":\"en\"},{\"created_at\":\"Fri Jan 12 17:19:15 +0000 2018\",\"id\":951866176556163072,\"id_str\":\"951866176556163072\",\"text\":\"1,300 acres of stunning panoramas, rolling Blue Ridge Mountains, large lakes and 210 acres of vines @TrumpWinery https://t.co/421e8vcACW\",\"truncated\":false,\"entities\":{\"hashtags\":[],\"symbols\":[],\"user_mentions\":[{\"screen_name\":\"trumpwinery\",\"name\":\"Trump Winery\",\"id\":361400752,\"id_str\":\"361400752\",\"indices\":[100,112]}],\"urls\":[],\"media\":[{\"id\":951863739501998082,\"id_str\":\"951863739501998082\",\"indices\":[113,136],\"media_url\":\"http://pbs.twimg.com/media/DTWzByOXcAIUxGT.jpg\",\"media_url_https\":\"https://pbs.twimg.com/media/DTWzByOXcAIUxGT.jpg\",\"url\":\"https://t.co/421e8vcACW\",\"display_url\":\"pic.twitter.com/421e8vcACW\",\"expanded_url\":\"https://twitter.com/Trump/status/951866176556163072/photo/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"large\":{\"w\":960,\"h\":640,\"resize\":\"fit\"},\"medium\":{\"w\":960,\"h\":640,\"resize\":\"fit\"},\"small\":{\"w\":680,\"h\":453,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":951863739501998082,\"id_str\":\"951863739501998082\",\"indices\":[113,136],\"media_url\":\"http://pbs.twimg.com/media/DTWzByOXcAIUxGT.jpg\",\"media_url_https\":\"https://pbs.twimg.com/media/DTWzByOXcAIUxGT.jpg\",\"url\":\"https://t.co/421e8vcACW\",\"display_url\":\"pic.twitter.com/421e8vcACW\",\"expanded_url\":\"https://twitter.com/Trump/status/951866176556163072/photo/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"large\":{\"w\":960,\"h\":640,\"resize\":\"fit\"},\"medium\":{\"w\":960,\"h\":640,\"resize\":\"fit\"},\"small\":{\"w\":680,\"h\":453,\"resize\":\"fit\"}}}]},\"metadata\":{\"iso_language_code\":\"en\",\"result_type\":\"recent\"},\"source\":\"<a href=\\\"http://twitter.com\\\" rel=\\\"nofollow\\\">Twitter Web Client</a>\",\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":720293443260456960,\"id_str\":\"720293443260456960\",\"name\":\"The Trump Organization\",\"screen_name\":\"Trump\",\"location\":\"New York, NY\",\"description\":\"The official Twitter page of The @Trump Organization. The most globally recognized brand in luxury real estate, golf, hospitality, and entertainment \uD83C\uDF0E\",\"url\":\"https://t.co/2qPo57KgoO\",\"entities\":{\"url\":{\"urls\":[{\"url\":\"https://t.co/2qPo57KgoO\",\"expanded_url\":\"http://TrumpStore.com\",\"display_url\":\"TrumpStore.com\",\"indices\":[0,23]}]},\"description\":{\"urls\":[]}},\"protected\":false,\"followers_count\":294711,\"friends_count\":50,\"listed_count\":1127,\"created_at\":\"Wed Apr 13 16:51:54 +0000 2016\",\"favourites_count\":3723,\"utc_offset\":-18000,\"time_zone\":\"Eastern Time (US & Canada)\",\"geo_enabled\":true,\"verified\":true,\"statuses_count\":479,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"is_translation_enabled\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_image_url_https\":\"https://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_tile\":false,\"profile_image_url\":\"http://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_image_url_https\":\"https://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_banner_url\":\"https://pbs.twimg.com/profile_banners/720293443260456960/1505756130\",\"profile_link_color\":\"B6B6B4\",\"profile_sidebar_border_color\":\"000000\",\"profile_sidebar_fill_color\":\"000000\",\"profile_text_color\":\"000000\",\"profile_use_background_image\":false,\"has_extended_profile\":false,\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"translator_type\":\"none\"},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":27,\"favorite_count\":157,\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"lang\":\"en\"},{\"created_at\":\"Thu Jan 11 14:57:29 +0000 2018\",\"id\":951468110703456259,\"id_str\":\"951468110703456259\",\"text\":\"We are very proud to announce that @TrumpVancouver, developed by the @HolbornGrp, has won the Best International Ho… https://t.co/g3OWQjSxEu\",\"truncated\":true,\"entities\":{\"hashtags\":[],\"symbols\":[],\"user_mentions\":[{\"screen_name\":\"TrumpVancouver\",\"name\":\"Trump Vancouver\",\"id\":1198111843,\"id_str\":\"1198111843\",\"indices\":[35,50]},{\"screen_name\":\"HolbornGrp\",\"name\":\"Holborn Group\",\"id\":2575639740,\"id_str\":\"2575639740\",\"indices\":[69,80]}],\"urls\":[{\"url\":\"https://t.co/g3OWQjSxEu\",\"expanded_url\":\"https://twitter.com/i/web/status/951468110703456259\",\"display_url\":\"twitter.com/i/web/status/9…\",\"indices\":[117,140]}]},\"metadata\":{\"iso_language_code\":\"en\",\"result_type\":\"recent\"},\"source\":\"<a href=\\\"https://ads.twitter.com\\\" rel=\\\"nofollow\\\">Twitter Ads</a>\",\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":720293443260456960,\"id_str\":\"720293443260456960\",\"name\":\"The Trump Organization\",\"screen_name\":\"Trump\",\"location\":\"New York, NY\",\"description\":\"The official Twitter page of The @Trump Organization. The most globally recognized brand in luxury real estate, golf, hospitality, and entertainment \uD83C\uDF0E\",\"url\":\"https://t.co/2qPo57KgoO\",\"entities\":{\"url\":{\"urls\":[{\"url\":\"https://t.co/2qPo57KgoO\",\"expanded_url\":\"http://TrumpStore.com\",\"display_url\":\"TrumpStore.com\",\"indices\":[0,23]}]},\"description\":{\"urls\":[]}},\"protected\":false,\"followers_count\":294711,\"friends_count\":50,\"listed_count\":1127,\"created_at\":\"Wed Apr 13 16:51:54 +0000 2016\",\"favourites_count\":3723,\"utc_offset\":-18000,\"time_zone\":\"Eastern Time (US & Canada)\",\"geo_enabled\":true,\"verified\":true,\"statuses_count\":479,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"is_translation_enabled\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_image_url_https\":\"https://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_tile\":false,\"profile_image_url\":\"http://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_image_url_https\":\"https://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_banner_url\":\"https://pbs.twimg.com/profile_banners/720293443260456960/1505756130\",\"profile_link_color\":\"B6B6B4\",\"profile_sidebar_border_color\":\"000000\",\"profile_sidebar_fill_color\":\"000000\",\"profile_text_color\":\"000000\",\"profile_use_background_image\":false,\"has_extended_profile\":false,\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"translator_type\":\"none\"},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":36,\"favorite_count\":135,\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"lang\":\"en\"},{\"created_at\":\"Wed Jan 10 15:24:41 +0000 2018\",\"id\":951112567207931904,\"id_str\":\"951112567207931904\",\"text\":\"Newly Engaged? Explore our portfolio of award-winning properties to bring your wedding day vision to life… https://t.co/wEoeqr8CYc\",\"truncated\":true,\"entities\":{\"hashtags\":[],\"symbols\":[],\"user_mentions\":[],\"urls\":[{\"url\":\"https://t.co/wEoeqr8CYc\",\"expanded_url\":\"https://twitter.com/i/web/status/951112567207931904\",\"display_url\":\"twitter.com/i/web/status/9…\",\"indices\":[107,130]}]},\"metadata\":{\"iso_language_code\":\"en\",\"result_type\":\"recent\"},\"source\":\"<a href=\\\"http://twitter.com\\\" rel=\\\"nofollow\\\">Twitter Web Client</a>\",\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":720293443260456960,\"id_str\":\"720293443260456960\",\"name\":\"The Trump Organization\",\"screen_name\":\"Trump\",\"location\":\"New York, NY\",\"description\":\"The official Twitter page of The @Trump Organization. The most globally recognized brand in luxury real estate, golf, hospitality, and entertainment \uD83C\uDF0E\",\"url\":\"https://t.co/2qPo57KgoO\",\"entities\":{\"url\":{\"urls\":[{\"url\":\"https://t.co/2qPo57KgoO\",\"expanded_url\":\"http://TrumpStore.com\",\"display_url\":\"TrumpStore.com\",\"indices\":[0,23]}]},\"description\":{\"urls\":[]}},\"protected\":false,\"followers_count\":294711,\"friends_count\":50,\"listed_count\":1127,\"created_at\":\"Wed Apr 13 16:51:54 +0000 2016\",\"favourites_count\":3723,\"utc_offset\":-18000,\"time_zone\":\"Eastern Time (US & Canada)\",\"geo_enabled\":true,\"verified\":true,\"statuses_count\":479,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"is_translation_enabled\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_image_url_https\":\"https://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_tile\":false,\"profile_image_url\":\"http://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_image_url_https\":\"https://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_banner_url\":\"https://pbs.twimg.com/profile_banners/720293443260456960/1505756130\",\"profile_link_color\":\"B6B6B4\",\"profile_sidebar_border_color\":\"000000\",\"profile_sidebar_fill_color\":\"000000\",\"profile_text_color\":\"000000\",\"profile_use_background_image\":false,\"has_extended_profile\":false,\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"translator_type\":\"none\"},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":40,\"favorite_count\":144,\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"lang\":\"en\"},{\"created_at\":\"Mon Jan 08 15:49:33 +0000 2018\",\"id\":950394047595798535,\"id_str\":\"950394047595798535\",\"text\":\"Rise and shine! It's the first working Monday of 2018 #MondayMotivation https://t.co/nyfgzZsI6a\",\"truncated\":false,\"entities\":{\"hashtags\":[{\"text\":\"MondayMotivation\",\"indices\":[54,71]}],\"symbols\":[],\"user_mentions\":[],\"urls\":[],\"media\":[{\"id\":950393468110688257,\"id_str\":\"950393468110688257\",\"indices\":[72,95],\"media_url\":\"http://pbs.twimg.com/media/DTB50ueW0AEMOFT.jpg\",\"media_url_https\":\"https://pbs.twimg.com/media/DTB50ueW0AEMOFT.jpg\",\"url\":\"https://t.co/nyfgzZsI6a\",\"display_url\":\"pic.twitter.com/nyfgzZsI6a\",\"expanded_url\":\"https://twitter.com/Trump/status/950394047595798535/photo/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":1200,\"h\":994,\"resize\":\"fit\"},\"small\":{\"w\":680,\"h\":564,\"resize\":\"fit\"},\"large\":{\"w\":2048,\"h\":1697,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":950393468110688257,\"id_str\":\"950393468110688257\",\"indices\":[72,95],\"media_url\":\"http://pbs.twimg.com/media/DTB50ueW0AEMOFT.jpg\",\"media_url_https\":\"https://pbs.twimg.com/media/DTB50ueW0AEMOFT.jpg\",\"url\":\"https://t.co/nyfgzZsI6a\",\"display_url\":\"pic.twitter.com/nyfgzZsI6a\",\"expanded_url\":\"https://twitter.com/Trump/status/950394047595798535/photo/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":1200,\"h\":994,\"resize\":\"fit\"},\"small\":{\"w\":680,\"h\":564,\"resize\":\"fit\"},\"large\":{\"w\":2048,\"h\":1697,\"resize\":\"fit\"}}}]},\"metadata\":{\"iso_language_code\":\"en\",\"result_type\":\"recent\"},\"source\":\"<a href=\\\"http://twitter.com\\\" rel=\\\"nofollow\\\">Twitter Web Client</a>\",\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":720293443260456960,\"id_str\":\"720293443260456960\",\"name\":\"The Trump Organization\",\"screen_name\":\"Trump\",\"location\":\"New York, NY\",\"description\":\"The official Twitter page of The @Trump Organization. The most globally recognized brand in luxury real estate, golf, hospitality, and entertainment \uD83C\uDF0E\",\"url\":\"https://t.co/2qPo57KgoO\",\"entities\":{\"url\":{\"urls\":[{\"url\":\"https://t.co/2qPo57KgoO\",\"expanded_url\":\"http://TrumpStore.com\",\"display_url\":\"TrumpStore.com\",\"indices\":[0,23]}]},\"description\":{\"urls\":[]}},\"protected\":false,\"followers_count\":294711,\"friends_count\":50,\"listed_count\":1127,\"created_at\":\"Wed Apr 13 16:51:54 +0000 2016\",\"favourites_count\":3723,\"utc_offset\":-18000,\"time_zone\":\"Eastern Time (US & Canada)\",\"geo_enabled\":true,\"verified\":true,\"statuses_count\":479,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"is_translation_enabled\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_image_url_https\":\"https://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_tile\":false,\"profile_image_url\":\"http://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_image_url_https\":\"https://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_banner_url\":\"https://pbs.twimg.com/profile_banners/720293443260456960/1505756130\",\"profile_link_color\":\"B6B6B4\",\"profile_sidebar_border_color\":\"000000\",\"profile_sidebar_fill_color\":\"000000\",\"profile_text_color\":\"000000\",\"profile_use_background_image\":false,\"has_extended_profile\":false,\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"translator_type\":\"none\"},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":74,\"favorite_count\":291,\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"lang\":\"en\"},{\"created_at\":\"Sat Jan 06 19:04:15 +0000 2018\",\"id\":949718272735408128,\"id_str\":\"949718272735408128\",\"text\":\"Happy Birthday, @EricTrump! \uD83C\uDF82 https://t.co/fTAzMSJlB8\",\"truncated\":false,\"entities\":{\"hashtags\":[],\"symbols\":[],\"user_mentions\":[{\"screen_name\":\"EricTrump\",\"name\":\"Eric Trump\",\"id\":39349894,\"id_str\":\"39349894\",\"indices\":[16,26]}],\"urls\":[],\"media\":[{\"id\":949718240648933376,\"id_str\":\"949718240648933376\",\"indices\":[30,53],\"media_url\":\"http://pbs.twimg.com/ext_tw_video_thumb/949718240648933376/pu/img/2uLSFZ151UkHhG-H.jpg\",\"media_url_https\":\"https://pbs.twimg.com/ext_tw_video_thumb/949718240648933376/pu/img/2uLSFZ151UkHhG-H.jpg\",\"url\":\"https://t.co/fTAzMSJlB8\",\"display_url\":\"pic.twitter.com/fTAzMSJlB8\",\"expanded_url\":\"https://twitter.com/Trump/status/949718272735408128/video/1\",\"type\":\"photo\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"small\":{\"w\":680,\"h\":680,\"resize\":\"fit\"},\"medium\":{\"w\":720,\"h\":720,\"resize\":\"fit\"},\"large\":{\"w\":720,\"h\":720,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":949718240648933376,\"id_str\":\"949718240648933376\",\"indices\":[30,53],\"media_url\":\"http://pbs.twimg.com/ext_tw_video_thumb/949718240648933376/pu/img/2uLSFZ151UkHhG-H.jpg\",\"media_url_https\":\"https://pbs.twimg.com/ext_tw_video_thumb/949718240648933376/pu/img/2uLSFZ151UkHhG-H.jpg\",\"url\":\"https://t.co/fTAzMSJlB8\",\"display_url\":\"pic.twitter.com/fTAzMSJlB8\",\"expanded_url\":\"https://twitter.com/Trump/status/949718272735408128/video/1\",\"type\":\"video\",\"sizes\":{\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"small\":{\"w\":680,\"h\":680,\"resize\":\"fit\"},\"medium\":{\"w\":720,\"h\":720,\"resize\":\"fit\"},\"large\":{\"w\":720,\"h\":720,\"resize\":\"fit\"}},\"video_info\":{\"aspect_ratio\":[1,1],\"duration_millis\":6000,\"variants\":[{\"bitrate\":1280000,\"content_type\":\"video/mp4\",\"url\":\"https://video.twimg.com/ext_tw_video/949718240648933376/pu/vid/720x720/G9hJqoP_rZNZKThV.mp4\"},{\"content_type\":\"application/x-mpegURL\",\"url\":\"https://video.twimg.com/ext_tw_video/949718240648933376/pu/pl/HxvswQuxbSMJaWv3.m3u8\"},{\"bitrate\":832000,\"content_type\":\"video/mp4\",\"url\":\"https://video.twimg.com/ext_tw_video/949718240648933376/pu/vid/480x480/KpQjl0vR0dVxMOql.mp4\"},{\"bitrate\":320000,\"content_type\":\"video/mp4\",\"url\":\"https://video.twimg.com/ext_tw_video/949718240648933376/pu/vid/240x240/KNFQ3UXoMIzh-pS3.mp4\"}]},\"additional_media_info\":{\"monetizable\":false}}]},\"metadata\":{\"iso_language_code\":\"en\",\"result_type\":\"recent\"},\"source\":\"<a href=\\\"http://twitter.com/download/iphone\\\" rel=\\\"nofollow\\\">Twitter for iPhone</a>\",\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":720293443260456960,\"id_str\":\"720293443260456960\",\"name\":\"The Trump Organization\",\"screen_name\":\"Trump\",\"location\":\"New York, NY\",\"description\":\"The official Twitter page of The @Trump Organization. The most globally recognized brand in luxury real estate, golf, hospitality, and entertainment \uD83C\uDF0E\",\"url\":\"https://t.co/2qPo57KgoO\",\"entities\":{\"url\":{\"urls\":[{\"url\":\"https://t.co/2qPo57KgoO\",\"expanded_url\":\"http://TrumpStore.com\",\"display_url\":\"TrumpStore.com\",\"indices\":[0,23]}]},\"description\":{\"urls\":[]}},\"protected\":false,\"followers_count\":294711,\"friends_count\":50,\"listed_count\":1127,\"created_at\":\"Wed Apr 13 16:51:54 +0000 2016\",\"favourites_count\":3723,\"utc_offset\":-18000,\"time_zone\":\"Eastern Time (US & Canada)\",\"geo_enabled\":true,\"verified\":true,\"statuses_count\":479,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"is_translation_enabled\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_image_url_https\":\"https://abs.twimg.com/images/themes/theme1/bg.png\",\"profile_background_tile\":false,\"profile_image_url\":\"http://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_image_url_https\":\"https://pbs.twimg.com/profile_images/875453116333871104/0WX0QPbl_normal.jpg\",\"profile_banner_url\":\"https://pbs.twimg.com/profile_banners/720293443260456960/1505756130\",\"profile_link_color\":\"B6B6B4\",\"profile_sidebar_border_color\":\"000000\",\"profile_sidebar_fill_color\":\"000000\",\"profile_text_color\":\"000000\",\"profile_use_background_image\":false,\"has_extended_profile\":false,\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null,\"translator_type\":\"none\"},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":166,\"favorite_count\":1250,\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"lang\":\"en\"}]\n";


        BufferedReader in = new BufferedReader(new StringReader(data));
        JsonReader jsonReader = Json.createReader(in);
        JsonArray array = jsonReader.readArray();
        jsonReader.close();

        Mockito.when(twitterAPIConnector.getData(preferences)).thenReturn(array);

        twitterAPIFetcher = new TwitterAPIFetcher(twitterAPIConnector);
    }


    @Test
    public void fetchTest() throws IOException {

        String expectedResult1 = "News Source: Trump, Keyword: Trump\n" +
                "https://twitter.com/statuses/953347857880354822\n" +
                "2018-01-16 20:26:56.0\n" +
                "Routed on over 500 acres and forged from what was previously flat and barren desert, @TrumpGolfDubai has become a p… https://t.co/2K5XAz7Yt1";
        String expectedResult2 = "News Source: Trump, Keyword: Trump\n" +
                "https://twitter.com/statuses/951892015654096896\n" +
                "2018-01-12 20:01:56.0\n" +
                "View our 4Q 2017 @TrumpRealty Luxury Market Report, featuring the latest luxury market statistics and analysis… https://t.co/2PrN1C3hBG";

        try {
            List<News> news = twitterAPIFetcher.fetch(preferences);

            assertEquals(news.get(0).toString(), expectedResult1);
            assertEquals(news.get(1).toString(), expectedResult2);

        } catch (exceptions.FetchingException e) {
            e.printStackTrace();
        }

    }

}
